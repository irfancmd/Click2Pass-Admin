<div class="row">
  <div class="col">
    <nb-card>
      <nb-card-header>Create a Question Set</nb-card-header>
      <nb-card-body>
        <form
          [formGroup]="questionSetForm"
          (ngSubmit)="onSubmit()"
          class="mt-3"
        >
          <div class="row">
            <div class="col-12 form-group">
              <label for="name" class="label">Question Set Name</label>
              <input
                formControlName="name"
                id="name"
                type="text"
                placeholder="Question Set Name"
                nbInput
                fullWidth
                required
              />
            </div>
          </div>

          <div class="row">
            <div class="col-12 form-group">
              <label for="description" class="label"
                >Question Set Description</label
              >
              <input
                formControlName="description"
                id="description"
                type="text"
                placeholder="Question Set Description"
                nbInput
                fullWidth
              />
            </div>
          </div>

          <div class="row">
            <div class="col-12 form-group">
              <label for="curriculumId" class="label"
                >Curriculum&nbsp;&nbsp;&nbsp;&nbsp;</label
              >
              <nb-select
                id="curriculumId"
                name="selectedCurriculum"
                formControlName="curriculumId"
                style="width: 100% !important"
              >
                <nb-option value="0">Select</nb-option>
                <nb-option
                  *ngFor="let selectItem of curriculumSelectItems"
                  [value]="selectItem.value"
                  >{{ selectItem.text }}</nb-option
                >
              </nb-select>
            </div>
          </div>

          <div class="row">
            <div class="col-12 form-group">
              <label for="numOfQuestions" class="label"
                >Number of Questions</label
              >
              <input
                formControlName="numOfQuestions"
                id="numOfQuestions"
                type="number"
                min="0"
                max="100"
                placeholder="Number of Questions"
                nbInput
                fullWidth
              />
            </div>
          </div>

          <div class="row">
            <div class="col-12 form-group">
              <h5>Questions</h5>

              <form
                class="mb-3"
                [formGroup]="questionSearch"
                (ngSubmit)="onSearch()"
              >
                <div class="row mt-3">
                  <div class="col-7">
                    <label for="search" class="label">Search</label>
                    <input
                      id="search"
                      type="text"
                      placeholder="Search"
                      formControlName="searchText"
                      nbInput
                      fullWidth
                    />
                  </div>
                  <div class="col-2">
                    <label for="chapterId" class="label"
                      >Chapter&nbsp;&nbsp;&nbsp;&nbsp;</label
                    >
                    <nb-select
                      id="chapterId"
                      name="selectedChapter"
                      formControlName="chapterId"
                      style="width: 100% !important"
                    >
                      <nb-option value="0">Select</nb-option>
                      <nb-option
                        *ngFor="let selectItem of chapterSelectItemsViewable"
                        [value]="selectItem.value"
                        >{{ selectItem.text }}</nb-option
                      >
                    </nb-select>
                  </div>
                  <div class="col-1">
                    <button
                      type="submit"
                      style="margin-top: 1.8rem !important"
                      nbButton
                      status="primary"
                    >
                      Search
                    </button>
                  </div>
                </div>
              </form>

              <div class="table-responsive">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th scope="col">Select</th>
                      <th scope="col">ID</th>
                      <th scope="col">Question</th>
                      <th scope="col">Curriculum</th>
                      <th scope="col">Chapter</th>
                      <th scope="col">Lesson</th>
                      <th scope="col">Question Media URL</th>
                      <th scope="col">QuestionType</th>
                      <th scope="col">Number of Visible Options</th>
                      <th scope="col">Correct Answer Option(s)</th>
                      <th scope="col">Answer Option 1</th>
                      <th scope="col">Option 1 Media</th>
                      <th scope="col">Answer Option 2</th>
                      <th scope="col">Option 2 Media</th>
                      <th scope="col">Answer Option 3</th>
                      <th scope="col">Option 3 Media</th>
                      <th scope="col">Answer Option 4</th>
                      <th scope="col">Option 4 Media</th>
                      <th scope="col">Answer Option 5</th>
                      <th scope="col">Option 5 Media</th>
                      <th scope="col">Answer Option 6</th>
                      <th scope="col">Option 6 Media</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let question of questions">
                      <td>
                        <nb-checkbox
                          status="primary"
                          [checked]="isQuestionSelected(question.id)"
                          (change)="onChangeCheckBox($event, question.id)"
                        ></nb-checkbox>
                      </td>
                      <td>{{ question.id }}</td>
                      <td>{{ question.questionText }}</td>
                      <td>{{ question.curriculum?.name ?? "N/A" }}</td>
                      <td>{{ question.chapter?.name ?? "N/A" }}</td>
                      <td>{{ question.lesson?.name ?? "N/A" }}</td>
                      <td>
                        <div *ngIf="question.questionMediaUrl; else elseBlock">
                          <img
                            alt="{{ question.questionText }}"
                            src="{{ IMG_ROOT + question.questionMediaUrl }}"
                            class="table-image"
                          />
                        </div>
                        <ng-template #elseBlock>N/A</ng-template>
                      </td>
                      <td>{{ getQuestionType(question) }}</td>
                      <td>{{ question.numberOfOptionsVisible ?? "N/A" }}</td>
                      <td>{{ question.correctAnswerText }}</td>
                      <td>{{ question.answerOption1Text }}</td>
                      <td>
                        <div
                          *ngIf="question.answerOption1MediaUrl; else elseBlock"
                        >
                          <img
                            alt="{{ questoin.answerOption1Text }}"
                            src="{{
                              IMG_ROOT + question.answerOption1MediaUrl
                            }}"
                            class="table-image"
                          />
                        </div>
                        <ng-template #elseBlock>N/A</ng-template>
                      </td>
                      <td>{{ question.answerOption2Text ?? "N/A" }}</td>
                      <td>
                        <div
                          *ngIf="question.answerOption2MediaUrl; else elseBlock"
                        >
                          <img
                            src="{{
                              IMG_ROOT + question.answerOption2MediaUrl
                            }}"
                            alt="{{ questoin.answerOption2Text }}"
                            class="table-image"
                          />
                        </div>
                        <ng-template #elseBlock>N/A</ng-template>
                      </td>
                      <td>{{ question.answerOption3Text ?? "N/A" }}</td>
                      <td>
                        <div
                          *ngIf="question.answerOption3MediaUrl; else elseBlock"
                        >
                          <img
                            alt="{{ questoin.answerOption3Text }}"
                            src="{{
                              IMG_ROOT + question.answerOption3MediaUrl
                            }}"
                            class="table-image"
                          />
                        </div>
                        <ng-template #elseBlock>N/A</ng-template>
                      </td>
                      <td>{{ question.answerOption4Text ?? "N/A" }}</td>
                      <td>
                        <div
                          *ngIf="question.answerOption4MediaUrl; else elseBlock"
                        >
                          <img
                            alt="{{ questoin.answerOption4Text }}"
                            src="{{
                              IMG_ROOT + question.answerOption4MediaUrl
                            }}"
                            class="table-image"
                          />
                        </div>
                        <ng-template #elseBlock>N/A</ng-template>
                      </td>
                      <td>{{ question.answerOption5Text ?? "N/A" }}</td>
                      <td>
                        <div
                          *ngIf="question.answerOption5MediaUrl; else elseBlock"
                        >
                          <img
                            alt="{{ questoin.answerOption5Text }}"
                            src="{{
                              IMG_ROOT + question.answerOption5MediaUrl
                            }}"
                            class="table-image"
                          />
                        </div>
                        <ng-template #elseBlock>N/A</ng-template>
                      </td>
                      <td>{{ question.answerOption6Text ?? "N/A" }}</td>
                      <td>
                        <div
                          *ngIf="question.answerOption6MediaUrl; else elseBlock"
                        >
                          <img
                            alt="{{ questoin.answerOption6Text }}"
                            src="{{
                              IMG_ROOT + question.answerOption6MediaUrl
                            }}"
                            class="table-image"
                          />
                        </div>
                        <ng-template #elseBlock>N/A</ng-template>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <button type="submit" nbButton status="primary">Submit</button>
        </form>
      </nb-card-body>
    </nb-card>
  </div>
</div>
